@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Pincode</h2>
<div data-ng-controller="pincodeCtrl">
    <div class="container ng-cloak">
        <div class="row-fluid form-horizontal">
            <div class="control-group span5">
                <label class="control-label">State</label>
                <div class="controls">
                    <select data-ng-model="selectedState" class="input-large" data-ng-change="changeState(selectedState)" data-ui-select2="">
                        <option value=""></option>
                        <option data-ng-repeat="s in States | orderBy: 'toString()'">{{s}}</option>
                    </select>
                </div>
            </div>
            <div class="control-group span6">
                <button class="btn btn-primary" data-ng-click="openAddModal()">Add New Pincode</button>
            </div>
        </div>

        <div class="row-fluid">
            <label class="control-label">Total Pincode : {{GPincodes.length}}</label>
        </div>
        <div class="row-fluid">
            <label class="control-label ">Filter Pincode : {{(GPincodes | filter:search | orderBy: 'Pincode').length}}</label>
        </div>
        <div class="row-fluid" style="overflow: auto; height: 600px">
            <table class="table table-bordered table-hover">
                <thead>
                    <tr>
                        <th></th>
                        <th>Pincode</th>
                        <th>Area</th>
                        <th>City</th>
                        <th>City Category</th>
                        <th>District</th>
                        <th>Cluster</th>
                        <th>Region</th>
                    </tr>
                    <tr>
                        <td></td>
                        <td>
                            <input class="input-small" type="text" data-ng-model="search.Pincode" required />
                        </td>
                        <td>
                            <input class="input-medium" type="text" data-ng-model="search.Area" required />
                        </td>
                        <td>
                            <input class="input-small" type="text" data-ng-model="search.City" required />
                        </td>
                        <td>
                            <select data-ng-model="search.CityCategory" class="input-medium" data-ui-select2="{allowClear:true}">
                                <option value=""></option>
                                <option data-ng-repeat="category in CityCategoryList">{{category}}</option>
                            </select>
                        </td>
                        <td>
                            <input class="input-small" type="text" data-ng-model="search.District" required />
                        </td>
                        <td>
                            <select data-ng-model="search.Cluster" class="input-medium" data-ui-select2="{allowClear:true}">
                                <option value=""></option>
                                <option data-ng-repeat="c in stateClusters">{{c}}</option>
                            </select>
                        </td>
                        <td>
                            <input class="input-small" type="text" data-ng-model="search.Region" required />
                        </td>
                    </tr>
                </thead>
                <tr data-ng-repeat="GPincode in GPincodes | filter:search | orderBy: 'Pincode'">
                    <td>
                        <div class="btn-group">
                            <i class="btn icon-edit" data-ng-click="openModel(GPincode)"></i>
                        </div>
                    </td>
                    <td>{{GPincode.Pincode}}</td>
                    <td>{{GPincode.Area}}</td>
                    <td>{{GPincode.City}}</td>
                    <td>{{GPincode.CityCategory}}</td>
                    <td>{{GPincode.District}}</td>
                    <td>{{GPincode.Cluster}}</td>
                    <td>{{GPincode.Region}}</td>
                </tr>
            </table>
        </div>
        <div class="bottom" style="height: 50px"></div>
        <!--Edit Modal PopUp-->
        <div modal="shouldBeOpen" close="closeModel()" options="modelOption">
            <div class="modal-header well">
                <h3>Edit Pincode</h3>
            </div>
            <div data-ng-form="formEditPincode" class="form-horizontal">
                <div class="modal-body">
                    <!--Country-->
                    <div class="control-group row-fluid">
                        <label class="control-label">Country </label>
                        <div class="controls">
                            <input type="text" value="India" readonly="readonly" />
                        </div>
                    </div>
                    <!--Region-->
                    <div class="control-group row-fluid">
                        <label class="control-label">Region</label>
                        <div class="controls">
                            <input type="text" data-ng-model="eGPincode.Region" readonly="readonly" />
                        </div>
                    </div>
                    <!--State-->
                    <div class="control-group row-fluid">
                        <label class="control-label">State</label>
                        <div class="controls">
                            <input type="text" data-ng-model="eGPincode.State" readonly="readonly" />
                        </div>
                    </div>
                    <!--Cluster-->
                    <div class="control-group row-fluid">
                        <label class="control-label">Cluster</label>
                        <div class="controls">
                            <input type="text" data-ng-model="eGPincode.Cluster" readonly="readonly" />
                        </div>
                    </div>
                    <!--District-->
                    <div class="control-group row-fluid">
                        <label class="control-label">District</label>
                        <div class="controls">
                            <input type="text" data-ng-model="eGPincode.District" readonly="readonly" />
                        </div>
                    </div>
                    <!--City-->
                    <div class="control-group row-fluid">
                        <label class="control-label">City</label>
                        <div class="controls">
                            <input type="text" data-ng-model="eGPincode.City"
                                name="city"
                                typeahead="c for c in pincodeCity($viewValue,eGPincode.District)" />
                            <div data-ng-show="formEditPincode.city.$dirty">
                                <span class="field-validation-error" data-ng-show="formEditPincode.city.$error.required">{{val.Required()}}</span>
                            </div>
                        </div>
                    </div>
                    <!--City Category-->
                    <div class="control-group row-fluid">
                        <label class="control-label">City Category</label>
                        <div class="controls">
                            <select class="input-large" ui-select2 data-ng-model="eGPincode.CityCategory" data-ng-required="isInEditMode">
                                <option></option>
                                <option data-ng-repeat="category in CityCategoryList">{{category}}</option>
                            </select>
                        </div>
                    </div>
                    <!--Area-->
                    <div class="control-group row-fluid">
                        <label class="control-label">Area</label>
                        <div class="controls">
                            <input type="text" name="area"
                                data-ng-model="eGPincode.Area"
                                required
                                typeahead="c  for c in pincodeArea($viewValue, eGPincode.City)"
                                data-ng-change="eGPincode.Area"
                                data-placeholder="Area" />
                            <div data-ng-show="formEditPincode.area.$dirty">
                                <span class="field-validation-error" data-ng-show="formEditPincode.area.$error.required">{{val.Required()}}</span>
                            </div>
                        </div>
                    </div>
                    <!--Pincode-->
                    <div class="control-group row-fluid">
                        <label class="control-label">Pincode</label>
                        <div class="controls">
                            <input type="text" data-ng-model="eGPincode.Pincode" readonly="readonly" />
                        </div>
                    </div>
                </div>
                <div class="modal-footer well">
                    <button class="btn btn-success" data-ng-click="editPincode(eGPincode)" data-ng-disabled="!formEditPincode.$valid">Save</button>
                    <button class="btn btn-primary" data-ng-hide="isInEditMode" data-ng-click="reset()">Reset</button>
                    <button class="btn btn-warning" data-ng-click="closeModel()">Close</button>
                </div>
            </div>
        </div>
    </div>
    <!--Add Modal popUp-->
    <div modal="shouldBeOpenAdd" close="closeModel()" options="modelOption">
        <div class="modal-header well">
            <h3>Add Pincode</h3>
        </div>
        <div data-ng-form="formEditPincode" class="form-horizontal">
            <div class="modal-body">
                <!--Country-->
                <div class="control-group row-fluid">
                    <label class="control-label">Country </label>
                    <div class="controls">
                        <input type="text" value="India" readonly="readonly" />
                    </div>
                </div>
                <!--Region-->
                <div class="control-group row-fluid">
                    <label class="control-label">Region</label>
                    <div class="controls">
                        <select ui-select2 class="input-large" data-ng-model="GPincodedata.Region" data-ng-change="getData(GPincodedata.Region);regionChange()"
                            data-ng-required="!isInEditMode">
                            <option></option>
                            <option data-ng-repeat="region in RegionList |unique:'Region'">{{region}}</option>
                        </select>
                    </div>
                </div>
                <!--State-->
                <div class="control-group row-fluid">
                    <label class="control-label">State</label>
                    <div class="controls">
                        <select class="input-large" data-ng-model="GPincodedata.State" ui-select2 data-ng-required="!isInEditMode"
                            data-ng-disabled="!GPincodedata.Region" data-ng-change="getData(GPincodedata.State);stateChange()">
                            <option></option>
                            <option data-ng-repeat="s in StateList |unique:'State'">{{s}}</option>
                        </select>
                    </div>
                </div>
                <!--Cluster-->
                <div class="control-group row-fluid">
                    <label class="control-label">Cluster</label>
                    <div class="controls">
                        <select class="input-large" ui-select2 name="cluster" data-ng-model="GPincodedata.Cluster" data-ng-required="!isInEditMode"
                            data-ng-disabled="!GPincodedata.State" data-ng-change="getData(GPincodedata.Cluster);clusterChange()">
                            <option></option>
                            <option data-ng-repeat="clust in ClusterList |unique:'Cluster' ">{{clust}}</option>
                        </select>
                    </div>
                </div>
                <!--District-->
                <div class="control-group row-fluid">
                    <label class="control-label">District</label>
                    <div class="controls">
                        <select class="input-large" ui-select2 name="district" data-ng-model="GPincodedata.District" data-ng-required="!isInEditMode"
                            data-ng-disabled="!GPincodedata.Cluster" data-ng-change="getData(GPincodedata.District);districtChange()">
                            <option></option>
                            <option data-ng-repeat="dist in DistrictList |unique:'District' ">{{dist}}</option>
                        </select>
                    </div>
                </div>
                <!--City-->
                <div class="control-group row-fluid">
                    <label class="control-label">City</label>
                    <div class="controls">
                        <span data-ng-hide="showTextBox">
                            <select class="input-large" ui-select2 data-ng-model="GPincodedata.City" data-ng-required="!isInEditMode"
                                data-ng-disabled="!GPincodedata.District" data-ng-change="cityChange()">
                                <option></option>
                                <option data-ng-repeat="city in CityList |unique:'City' ">{{city}}</option>
                            </select>
                        </span>
                        <span data-ng-show="showTextBox">
                            <input type="text" class="input-large" data-ng-model="GPincodedata.City" data-ng-required="!isInEditMode" />
                        </span>
                        <button class="btn btn-success" data-ng-click="addNewCity()" data-ng-hide="showTextBox" data-ng-disabled="!citydata">Add New City</button>
                        <button class="btn btn-warning" data-ng-click="cancleAddCity()" data-ng-show="showTextBox">Not Now</button>
                    </div>
                </div>

                <!--City Category-->
                <div class="control-group row-fluid">
                    <label class="control-label">City Category</label>
                    <div class="controls">
                        <select class="input-large" ui-select2 data-ng-model="GPincodedata.CityCategory"
                            data-ng-disabled="!GPincodedata.City" data-ng-required="!isInEditMode">
                            <option></option>
                            <option data-ng-repeat="category in CityCategoryList">{{category}}</option>
                        </select>
                    </div>
                </div>
                <!--Area-->
                <div class="control-group row-fluid">
                    <label class="control-label">Area</label>
                    <div class="controls">
                        <input type="text" name="area"
                            data-ng-model="GPincodedata.Area"
                            required
                            typeahead="c for c in pincodeArea($viewValue,GPincodedata.City)"
                            data-ng-change="areaChange()"
                            data-ng-disabled="!GPincodedata.CityCategory"
                            data-placeholder="Area" />
                        <div data-ng-show="formEditPincode.area.$dirty">
                            <span class="field-validation-error" data-ng-show="formEditPincode.area.$error.required">{{val.Required()}}</span>
                        </div>
                    </div>
                </div>
                <!--Pincode-->
                <div class="control-group row-fluid">
                    <label class="control-label">Pincode</label>
                    <div class="controls">
                        <input type="text" name="pincode" data-ng-model="GPincodedata.Pincode" required data-ng-change="pincodedata(GPincodedata.Pincode)"
                            data-ng-disabled="!GPincodedata.Area" data-ng-pattern="/^[0-9]{6}$/"
                            typeahead="c for c in missingPincode($viewValue)" />
                        <div data-ng-show="formEditPincode.pincode.$dirty">
                            <span class="field-validation-error" data-ng-show="formEditPincode.pincode.$error.required && !alreadyExit">{{val.Required()}}</span>
                            <div class="field-validation-error" data-ng-show="formEditPincode.pincode.$error.pattern">{{val.Pattern(6)}}</div>
                            <div class="field-validation-error" data-ng-show="alreadyExit">{{val.AlreadyExist(dummyPincode)}}</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer well">
                <button class="btn btn-success" data-ng-click="editPincode(GPincodedata)" data-ng-disabled="!formEditPincode.$valid || alreadyExit">Save</button>
                <button class="btn btn-primary" data-ng-hide="isInEditMode" data-ng-click="reset()">Reset</button>
                <button class="btn btn-warning" data-ng-click="closeModel()">Close</button>
            </div>
        </div>
    </div>

</div>
@section scripts{
    <script src="~/Areas/Generic/ViewModels/pincodeCtrl.js"></script>
}
