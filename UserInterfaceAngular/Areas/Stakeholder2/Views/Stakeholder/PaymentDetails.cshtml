@{
    ViewBag.Title = "PaymentDetails";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<div class="container-fluid">
    <div class="row-fluid" data-ng-cloak="" data-ng-controller="PaymentDetails">
        <form name="formPayment" class="form-horizontal" novalidate>
            <div class="panel">
                <div class="panel-heading">
                    Payment Details 
                </div>
                <!--Stakeholder Payment-->
                <div class="row-fluid">
                    <div class="row-fluid">
                        <div class="span5 control-group">
                            <div class="controls">
                                <div class="input-prepend">
                                    <span class="add-on">Payment
                                        <input type="radio" data-ng-model="ShowPayment" name="sreen" checked="checked" value="1"><label>On</label>
                                        <input type="radio" data-ng-model="ShowPayment" name="sreen" value="0"><label>Off</label>
                                        Stakhholder
                                        <input type="radio" data-ng-model="Stakeholder" name="sreen" checked="checked" value="1"><label>On</label>
                                        <input type="radio" data-ng-model="Stakeholder" name="sreen" value="0"><label>Off</label>
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="span12" data-ng-show="ShowPayment">
                        <!--Date Range-->
                        <div class="row-fluid">
                            <h5 style="font-weight: normal;">Date Range</h5>
                            <hr />
                            <div class="row-fluid">
                                <div class="control-group span6">
                                    <label class="control-label">Start Date</label>
                                    <div class="controls">
                                        <input type="text" class="input-medium" name="StartDate"
                                            readonly
                                            data-ng-required="Hierarchy.HasPayment"
                                            data-ng-model="Stakeholder.Payment.StartDate"
                                            data-date-format="dd-mm-yyyy" bs-datepicker>
                                        <button type="button" class="btn" data-toggle="datepicker"><i class="icon-calendar"></i></button>
                                    </div>
                                </div>
                                <div class="control-group span6">
                                    <label class="control-label">End Date</label>
                                    <div class="controls">
                                        <div class="">
                                            <input type="text" class="input-medium"
                                                readonly
                                                data-ng-required="Hierarchy.HasPayment"
                                                data-ng-model="Stakeholder.Payment.EndDate"
                                                data-date-format="dd-mm-yyyy"
                                                ui-validate="'OneMonthGreater($value, Stakeholder.Payment.StartDate)'" bs-datepicker>
                                            <button type="button" name="EndDate" class="btn" data-toggle="datepicker"><i class="icon-calendar"></i></button>
                                            <div class="error" data-ng-show="EndDate">
                                                <span class="error" data-ng-show="EndDate">{{DateOneMonthGreater}} </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!--Variable Payment-->
                        <div class="row-fluid" data-ng-show="!Hierarchy.HasVarible">
                            <h5 style="font-weight: normal;">Variable Pay</h5>
                            <hr />

                            <div class="row-fluid">
                                <div class="control-group span6">
                                    <label class="control-label">Collection Policy:</label>
                                    <div class="controls">
                                        <select data-ui-select2="" id="linerPolicy" data-ng-required="!Stakeholder.Payment.VariableWriteoff" data-ng-model="Stakeholder.Payment.VariableLiner" data-ng-options="c for c in LinerPolicyList" style="min-width: 200px;"></select>
                                    </div>
                                </div>
                                <div class="control-group span6">
                                    <label class="control-label">Recovery Policy:</label>
                                    <div class="controls">
                                        <select data-ui-select2="" id="writeoffPolicy" data-ng-required="!Stakeholder.Payment.VariableLiner" data-ng-model="Stakeholder.Payment.VariableWriteoff" data-ng-options="c for c in WriteoffPolicies" style="min-width: 200px;"></select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!--Fixed Pay-->
                        <div class="row-fluid" data-ng-show="!Hierarchy.HasFixed">
                            <h5 style="font-weight: normal;">Fixed Pay</h5>
                            <hr />
                            <div class="row-fluid">
                                <div class="row-fluid">
                                    <div class="control-group span6">
                                        <label class="control-label">Basic :</label>
                                        <div class="controls">
                                            <div class="input-prepend">
                                                <span class="add-on"><i class="icon-rupee"></i></span>
                                                <input type="number" name="FixpayBasic" data-ng-required="!Hierarchy.HasFixed" min="0" data-ng-maxlength="5" data-ng-model="Stakeholder.Payment.FixpayBasic" />
                                            </div>
                                            <div class="error">
                                                <span class="field-validation-error" data-ng-show="formPayment.FixpayBasic.$error.maxlength">{{val.MaxLength('5')}}</span>
                                                <span class="field-validation-error" data-ng-show="formPayment.FixpayBasic.$error.min">{{ val.MinLength('0')}} </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="control-group span6" data-ng-show="!Hierarchy.HasFixedIndividual">
                                        <label class="control-label">Hra :</label>
                                        <div class="controls">
                                            <div class="input-prepend">
                                                <span class="add-on"><i class="icon-rupee"></i></span>
                                                <input type="number" data-ng-required="!Hierarchy.HasFixedIndividual" min="0" data-ng-maxlength="5" data-ng-model="Stakeholder.Payment.FixpayHra" name="FixpayHra" />
                                            </div>
                                            <div class="error">
                                                <span class="field-validation-error" data-ng-show="formPayment.FixpayHra.$error.maxlength">{{val.MaxLength('5')}}</span>
                                                <span class="field-validation-error" data-ng-show="formPayment.FixpayHra.$error.min">{{ val.MinLength('0')}} </span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="row-fluid">
                                    <div class="control-group span6" data-ng-show="!Hierarchy.HasFixedIndividual">
                                        <label class="control-label">Other :</label>
                                        <div class="controls">
                                            <div class="input-prepend">
                                                <span class="add-on"><i class="icon-rupee"></i></span>
                                                <input type="number" data-ng-required="!Hierarchy.HasFixedIndividual" min="0" data-ng-maxlength="5" data-ng-model="Stakeholder.Payment.FixpayOther" name="FixpayOther" />
                                            </div>
                                            <div class="error">
                                                <span class="field-validation-error" data-ng-show="formPayment.FixpayOther.$error.maxlength">{{val.MaxLength('5')}}</span>
                                                <span class="field-validation-error" data-ng-show="formPayment.FixpayOther.$error.min">{{ val.MinLength('0')}} </span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="control-group span6 info" data-ng-show="false">
                                        <label class="control-label">Total:</label>
                                        <div class="controls">
                                            <div class="input-prepend">
                                                <span class="add-on"><i class="icon-rupee"></i></span>
                                                <input type="text" data-ng-model="Stakeholder.Payment.FixpayTotal" disabled value="{{Stakeholder.Payment.FixpayTotal=TotalPayment(Stakeholder.Payment.FixpayBasic,Stakeholder.Payment.FixpayHra,Stakeholder.Payment.FixpayOther)}}" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row-fluid" data-ng-show="!Hierarchy.HasFixedIndividual">
                                <table class="table table-bordered table-hover" data-ng-show="Stakeholder.Payment.FixpayBasic">
                                    <thead>
                                        <tr>
                                            <th data-ng-show="Stakeholder.Payment.FixpayBasic">Basic</th>
                                            <th data-ng-show="Stakeholder.Payment.FixpayHra && Stakeholder.Payment.FixpayOther">Allowances</th>
                                            <th data-ng-show="Stakeholder.Payment.FixpayBasic">Employee PF</th>
                                            <th data-ng-show="Stakeholder.Payment.FixpayBasic">Employer PF</th>
                                            <th>Employee ESIC</th>
                                            <th>Employer ESIC</th>
                                            <th>Service Charge</th>
                                            <th>Service Tax</th>
                                            <th>Gross Pay</th>
                                        </tr>
                                        <tr>
                                            <th data-ng-show="Stakeholder.Payment.FixpayBasic"></th>
                                            <th data-ng-show="Stakeholder.Payment.FixpayHra && Stakeholder.Payment.FixpayOther"></th>
                                            <th data-ng-show="Stakeholder.Payment.FixpayBasic">Basic * {{FixedPay.EmployeePF}}%</th>
                                            <th data-ng-show="Stakeholder.Payment.FixpayBasic">Basic * {{FixedPay.EmployerPF}}%</th>
                                            <th>Basic * {{FixedPay.EmployeeESIC}}%</th>
                                            <th>Basic * {{FixedPay.EmployerESIC}}% </th>
                                            <th>Basic * {{FixedPay.ServiceCharge}}%</th>
                                            <th>Basic * {{FixedPay.ServiceTax}}% </th>
                                            <th></th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td data-ng-show="Stakeholder.Payment.FixpayBasic">{{Stakeholder.Payment.FixpayBasic}}</td>
                                            <td data-ng-show="Stakeholder.Payment.FixpayHra && Stakeholder.Payment.FixpayOther">{{Stakeholder.Payment.FixpayHra*1 + Stakeholder.Payment.FixpayOther*1}}
                                            </td>

                                            <td data-ng-show="Stakeholder.Payment.FixpayBasic">{{(SalDetails.pf*1)}}</td>
                                            <td data-ng-show="Stakeholder.Payment.FixpayBasic">{{(SalDetails.pf*1)}}</td>
                                            <td>{{SalDetails.esicEmployee}}</td>
                                            <td>{{SalDetails.esicEmployer}}</td>
                                            <td>{{SalDetails.serviceCharge}}</td>
                                            <td>{{SalDetails.serviceTax}}</td>
                                            <td>{{Stakeholder.Payment.FixpayTotal}}</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!--Allowances-->
                        <div class="row-fluid" data-ng-show="!Hierarchy.HasMobileTravel">
                            <h5 style="font-weight: normal;">Reimbursements</h5>
                            <hr />

                            <div class="row-fluid">
                                <div class="control-group span6">
                                    <label class="control-label">Mobile:</label>
                                    <div class="controls">
                                        <input type="number" data-ng-required="!Hierarchy.HasMobileTravel" min="0" data-ng-maxlength="5" data-ng-model="Stakeholder.Payment.MobileElig" name="MobileElig" />
                                        <div class="error">
                                            <span class="field-validation-error" data-ng-show="formPayment.MobileElig.$error.maxlength">{{val.MaxLength('5')}}</span>
                                            <span class="field-validation-error" data-ng-show="formPayment.MobileElig.$error.min">{{ val.MinLength('0')}} </span>
                                        </div>
                                    </div>
                                </div>
                                <div class="control-group span6">
                                    <label class="control-label">Travel:</label>
                                    <div class="controls">
                                        <input type="number" data-ng-required="!Hierarchy.HasMobileTravel" min="0" data-ng-maxlength="5" data-ng-model="Stakeholder.Payment.TravelElig" name="TravelElig" />
                                        <div class="error">
                                            <span class="field-validation-error" data-ng-show="formPayment.TravelElig.$error.maxlength">{{val.MaxLength('5')}}</span>
                                            <span class="field-validation-error" data-ng-show="formPayment.TravelElig.$error.min">{{ val.MinLength('0')}} </span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!--Bank details-->
                        <div class="row-fluid" data-ng-show="false">
                            <h5 style="font-weight: normal;">Bank Details</h5>
                            <hr />
                            <div class="row-fluid">
                                <div class="row-fluid">
                                    <div class="control-group span6">
                                        <label class="control-label">Bank Acc. No:</label>
                                        <div class="controls">
                                            <input type="text" data-ng-pattern="/^[0-9a-zA-Z]+$/" data-ng-maxlength="25" data-ng-minlength="11" data-ng-model="Stakeholder.Payment.BankAccNo" name="BankAccNo" />
                                            <div class="error">
                                                <span class="field-validation-error" data-ng-show="formPayment.BankAccNo.$error.maxlength">{{Maxlength25}}</span>
                                                <span class="field-validation-error" data-ng-show="formPayment.BankAccNo.$error.minlength">{{Minlength11}}</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="control-group span6" data-ng-show="Stakeholder.Payment.BankAccNo">
                                        <label class="control-label">Bank Name:</label>
                                        <div class="controls">
                                            <input type="text" data-ng-required="Stakeholder.Payment.BankAccNo" data-ng-maxlength="100" data-ng-model="Stakeholder.Payment.BankAccName" name="BankAccName" />
                                            <div class="error">
                                                <span class="field-validation-error" data-ng-show="formPayment.BankAccName.$error.maxlength">{{Maxlength100}}</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="row-fluid" data-ng-show="Stakeholder.Payment.BankAccNo && Stakeholder.Payment.BankAccName">
                                    <div class="control-group span6">
                                        <label class="control-label">Bank IFSC No:</label>
                                        <div class="controls">
                                            <input type="text" data-ng-required="Stakeholder.Payment.BankAccNo && Stakeholder.Payment.BankAccName" data-ng-pattern="/^[A-Z][A-Z][A-Z][A-Z][0-9][0-9][0-9][0-9][0-9][0-9][0-9]$/" value=" " data-ng-model="Stakeholder.Payment.BankIfscCode" name="BankIfscCode" placeholder="Ex : AAAA0000000" />
                                            <div class="error">
                                                <span class="field-validation-error" data-ng-show="formPayment.BankIfscCode.$error.pattern">Enter valid IFSC no</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!--Other Pay-->
                        <div class="row-fluid" data-ng-show="!Hierarchy.HasServiceCharge">
                            <h5 style="font-weight: normal;">Other Charges</h5>
                            <hr />
                            <div class="row-fluid">
                                <div class="control-group span6">
                                    <label class="control-label">Service Charge:</label>
                                    <div class="controls">
                                        <div class="input-append">
                                            <input type="text"
                                                data-ng-required="!Hierarchy.HasServiceCharge"
                                                data-ng-pattern="/^100$|^\d{0,2}(\.\d{1,2})? *%?$/"
                                                data-ng-maxlength="99.99"
                                                class="input-mini"
                                                data-ng-model="Stakeholder.Payment.ServiceCharge" name="ServiceCharge" />
                                            <span class="add-on">%</span>
                                        </div>
                                        <div class="error">
                                            <span class="field-validation-error" data-ng-show="formPayment.ServiceCharge.$error.pattern">Enter valid percentage</span>
                                            <span class="field-validation-error" data-ng-show="formPayment.ServiceCharge.$error.maxlength">Max Length 99.99</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!--Save button-->
                        <div class="row-fluid">
                            <div class="text-center">
                                <input type="submit" value="Save" data-ng-disabled="form.$invalid" class="btn btn-success" data-ng-click="AddPayment(Stakeholder,Hierarchy)" />
                                <input type="submit" value="Reset" data-ng-disabled="!Hierarchy" data-ng-click="clear()" class="btn btn-info" />
                            </div>
                        </div>
                    </div>

                    <div data-ng-show="Stakeholder">
                        <div class="span12">
                            <div class="panel-heading">
                                Stakhholder
                            </div>

                            <!--Working Details-->
                            <div class="row-fluid">
                                <h5 style="font-weight: normal;">Working Details</h5>
                                <hr />
                                <div class="row-fluid">
                                    <div class="control-group span6">
                                        <label class="control-label">Products:</label>
                                        <div class="controls">
                                            <select data-ui-select2="" data-ng-required="true" data-ng-model="StakeWork.Products" data-ng-options="c for c in ProductList" data-ng-change="GetReport2List(StakeWork.Products)" style="min-width: 200px;"></select>
                                        </div>
                                    </div>
                                    <div class="control-group span6">
                                        <label class="control-label">Reports To:</label>
                                        <div class="controls">
                                            <select data-ui-select2="" data-ng-required="true" data-ng-model="StakeWork.ReportsTo" data-ng-options="c.Name for c in ReportsToList" style="min-width: 200px;"></select>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!--Working Table-->
                            <div class="row-fluid">
                                <h5 style="font-weight: normal;">Fixed Pay</h5>
                                <hr />
                                <div class="row-fluid">
                                    <table class="table table-bordered table-hover">
                                        <thead>
                                            <tr>
                                                <th>Product</th>
                                                <th>Country</th>
                                                <th>Region</th>
                                                <th>State</th>
                                                <th>Pincode</th>
                                                <th>Cluster</th>
                                                <th>Area</th>
                                                <th>Bucket</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                @*Product*@
                                                <td>{{StakeWork.Products}}</td>
                                                @*Country*@
                                                <td>
                                                    <input value="India" readonly />
                                                </td>

                                                @*Region*@
                                                <td>
                                                    <select data-ui-select2="" id="Region" class="select-working"
                                                            data-ng-model="StakeWork.Region">
                                                        <option>North India</option>
                                                        <option>East India</option>
                                                        <option>Central India</option>
                                                        <option>South India</option>
                                                        <option>West India</option>
                                                    </select>
                                                </td>

                                                @*State*@
                                                <td>
                                                    <select data-ui-select2="" id="state1" class="select-working"
                                                            data-ng-model="StakeWork.State"
                                                            data-ng-options="c for c in StateList | unique">
                                                    </select>
                                                </td>

                                                @*Pincode*@
                                                <td>
                                                    <input type="text"
                                                           class="input-medium" data-ng-model="StakeWork.Pincodes"
                                                           typeahead="c.City for c in Pincodes($viewValue, 'Area') ">
                                                </td>

                                                @*Cluster*@
                                                <td>
                                                    <input type="text" id="Cluster" class="select-working"
                                                           data-ng-model="StakeWork.Cluster"
                                                           typeahead="c.Cluster for c in Clusters($viewValue)"
                                                           typeahead-wait-ms="400">
                                                    </input>
                                                </td>

                                                @*Area*@
                                                <td>
                                                    <input type="text"
                                                           class="input-medium" data-ng-model="StakeWork.Area"
                                                           typeahead="c.Area for c in Pincodes($viewValue, 'Area')">
                                                </td>

                                                @*Bucket*@
                                                <td>
                                                    <select data-ui-select2="" class="select-working" multiple="multiple" 
                                                            data-ng-model="StakeWork.BucketStart">
                                                        <option value="1">1(0-29)</option>
                                                        <option value="2">2(30-59)</option>
                                                        <option value="3">3(60-89)</option>
                                                        <option value="4">4(90-119)</option>
                                                        <option value="5">5(120-149)</option>
                                                        <option value="6">6(150-179)</option>
                                                        <option value="7">>6(180+)</option>
                                                    </select>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>
                                                    <button type="button" class="btn btn-success" ng-click="addTable(StakeWork)">Add</button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <th>Product</th>
                                                <th>Country</th>
                                                <th>Region</th>
                                                <th>State</th>
                                                <th>Pincode</th>
                                                <th>Cluster</th>
                                                <th>Area</th>
                                                <th>Bucket</th>
                                            </tr>
                                            <tr data-ng-repeat="data in Stakeinfo"> 
                                                <td>{{data.Product}}</td>
                                                <td>{{data.Country}}</td>
                                                <td>{{data.Region}}</td>
                                                <td>{{data.State}}</td>
                                                <td>{{data.Pincode}}</td>
                                                <td>{{data.Cluster}}</td>
                                                <td>{{data.Area}}</td>
                                                <td>{{data.Bucket}}</td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                            <!--Save button-->
                            <div class="row-fluid">
                                <div class="text-center">
                                    <input type="submit" value="Save" data-ng-disabled="form.$invalid" class="btn btn-success" data-ng-click="AddPayment(Stakeholder,Hierarchy)" />
                                    <input type="submit" value="Reset" data-ng-disabled="!Hierarchy" data-ng-click="clear()" class="btn btn-info" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>
    </div>
</div>



@section scripts
{
    <script src="~/Areas/Stakeholder2/ViewModels/Payments.js"></script>
}
